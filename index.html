<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="color-scheme" content="dark" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>ScoobyCare</title>
  <meta name="theme-color" content="#6D5EFc" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" type="image/png" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <button id="menu-toggle" class="menu-toggle" aria-label="Abrir menu" aria-expanded="false">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <h1 id="screen-title" class="screen-title">Dashboard</h1>
    <div class="header-actions">
      <span id="online-status" class="status-badge online">Online</span>
      <span id="sync-status" class="status-badge muted">Salvo</span>
    </div>
  </header>

  <div class="app-shell">
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-brand">
        <div class="sidebar-logo">üê∂</div>
        <div class="sidebar-brand-text">
          <div class="sidebar-brand-name">ScoobyCare</div>
          <div class="sidebar-brand-sub">Sa√∫de do Scooby</div>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <a href="#home" class="sidebar-link active" data-route="home">
          <span class="sidebar-icon">üè†</span>
          <span class="sidebar-label">Dashboard</span>
        </a>
        <a href="#peso" class="sidebar-link" data-route="peso">
          <span class="sidebar-icon">‚öñÔ∏è</span>
          <span class="sidebar-label">Peso</span>
        </a>
        <a href="#meds" class="sidebar-link" data-route="meds">
          <span class="sidebar-icon">üíä</span>
          <span class="sidebar-label">Rem√©dios</span>
        </a>
        <a href="#vaccines" class="sidebar-link" data-route="vaccines">
          <span class="sidebar-icon">üõ°Ô∏è</span>
          <span class="sidebar-label">Vacinas</span>
        </a>
        <a href="#routines" class="sidebar-link" data-route="routines">
          <span class="sidebar-icon">‚úÖ</span>
          <span class="sidebar-label">Rotinas</span>
        </a>
        <a href="#food" class="sidebar-link" data-route="food">
          <span class="sidebar-icon">ü•£</span>
          <span class="sidebar-label">Comida</span>
        </a>
        <a href="#history" class="sidebar-link" data-route="history">
          <span class="sidebar-icon">üïí</span>
          <span class="sidebar-label">Hist√≥rico</span>
        </a>
        <a href="#settings" class="sidebar-link" data-route="settings">
          <span class="sidebar-icon">‚öôÔ∏è</span>
          <span class="sidebar-label">Ajustes</span>
        </a>
      </nav>
    </aside>

    <div id="overlay" class="overlay hidden"></div>

    <main class="content">
      <section data-view="home" class="view">
        <div class="hero">
          <div class="hero-left">
            <div class="hero-title">E a√≠, Scooby!</div>
            <div id="hero-sub" class="hero-sub">Vamos manter tudo em dia üß†‚ö°</div>
            <div class="hero-chips">
              <span id="hero-weight" class="chip">√öltimo peso: ‚Äî</span>
              <span id="hero-next" class="chip">Pr√≥ximo: ‚Äî</span>
            </div>
          </div>
          <div class="hero-right" aria-hidden="true">
            <div class="hero-avatar">üêæ</div>
          </div>
        </div>

        <div id="home-alerts" class="card"></div>

        <div class="grid">
          <div class="card">
            <h2>Pr√≥ximos eventos</h2>
            <div id="home-upcoming" class="list"></div>
          </div>

          <div class="card">
            <h2>Perfil</h2>
            <div id="home-profile" class="small-text"></div>
          </div>
        </div>
      </section>

      <section data-view="peso" class="view hidden">
        <h1>Peso</h1>
        <form id="weight-form" class="card form-card">
          <div class="field">
            <label for="weight-date">Data</label>
            <input id="weight-date" type="date" required />
          </div>
          <div class="field">
            <label for="weight-kg">Peso (kg)</label>
            <input id="weight-kg" type="number" min="0" step="0.01" placeholder="Ex: 13.65" required />
          </div>
          <div class="field">
            <label for="weight-note">Observa√ß√£o (opcional)</label>
            <input id="weight-note" type="text" placeholder="Ex: p√≥s passeio, jejum, etc." />
          </div>
          <button type="submit" class="btn primary">Salvar peso</button>
        </form>

        <div class="card">
          <h2>Registros</h2>
          <div id="weight-list" class="list"></div>
        </div>
      </section>

      <section data-view="meds" class="view hidden">
        <h1>Medicamentos & Parasitas</h1>

        <form id="med-form" class="card form-card">
          <div class="field">
            <label for="med-name">Nome</label>
            <input id="med-name" type="text" placeholder="Ex: Bravecto" required />
          </div>
          <div class="field">
            <label for="med-dose">Dose / faixa</label>
            <input id="med-dose" type="text" placeholder="Ex: 10‚Äì20 kg" />
          </div>
          <div class="field">
            <label for="med-interval">Intervalo (dias)</label>
            <input id="med-interval" type="number" min="1" value="90" required />
          </div>
          <button type="submit" class="btn primary">Adicionar</button>
        </form>

        <div class="card">
          <h2>Lista</h2>
          <div id="med-list" class="card-grid"></div>
        </div>
      </section>

      <section data-view="vaccines" class="view hidden">
        <h1>Vacinas</h1>

        <form id="vaccine-form" class="card form-card">
          <div class="field">
            <label for="vaccine-name">Nome da vacina</label>
            <input id="vaccine-name" type="text" placeholder="Ex: Antirr√°bica" required />
          </div>
          <div class="field">
            <label for="vaccine-interval">Intervalo (dias)</label>
            <input id="vaccine-interval" type="number" min="1" value="365" required />
          </div>
          <button type="submit" class="btn primary">Adicionar vacina</button>
          <p class="hint">Dica: se for refor√ßo anual, use 365 dias.</p>
        </form>

        <div class="card">
          <h2>Carteira</h2>
          <div id="vaccines-list" class="card-grid"></div>
        </div>
      </section>

      <section data-view="routines" class="view hidden">
        <h1>Rotinas</h1>

        <form id="routine-form" class="card form-card">
          <div class="field">
            <label for="routine-name">Rotina</label>
            <input id="routine-name" type="text" placeholder="Ex: Exame de fezes" required />
          </div>
          <div class="field">
            <label for="routine-every">A cada (meses)</label>
            <input id="routine-every" type="number" min="1" value="1" required />
          </div>
          <button type="submit" class="btn primary">Adicionar rotina</button>
          <p class="hint">Exame de fezes: 1 | Verm√≠fugo: 6</p>
        </form>

        <div class="card">
          <h2>Lista</h2>
          <div id="routine-list" class="card-grid"></div>
        </div>
      </section>

      <section data-view="food" class="view hidden">
        <h1>Alimenta√ß√£o</h1>

        <form id="food-form" class="card form-card">
          <div class="field">
            <label for="food-text">Rotina atual</label>
            <textarea id="food-text" rows="3" required></textarea>
          </div>
          <div class="field">
            <label for="food-notes">Observa√ß√µes (opcional)</label>
            <textarea id="food-notes" rows="2"></textarea>
          </div>
          <button type="submit" class="btn primary">Salvar alimenta√ß√£o</button>
        </form>

        <div class="card">
          <h2>Atual</h2>
          <div id="food-current" class="small-text"></div>
        </div>

        <div class="card">
          <h2>Hist√≥rico</h2>
          <div id="food-history" class="list"></div>
        </div>
      </section>

      <section data-view="history" class="view hidden">
        <h1>Hist√≥rico</h1>
        <div class="card">
          <h2>Linha do tempo</h2>
          <div id="timeline" class="list"></div>
        </div>
      </section>
      <section data-view="alerts" class="view hidden">
        <h1>Central de Pend√™ncias</h1>

        <div class="card">
          <div class="filters-row">
            <button class="chip active" data-alert-filter="all">Tudo</button>
            <button class="chip" data-alert-filter="late">Vencidos</button>
            <button class="chip" data-alert-filter="soon">Vencendo</button>
            <button class="chip" data-alert-filter="ok">Em dia</button>
          </div>
          <div id="alerts-summary" class="small-text" style="margin-top:10px"></div>
        </div>

        <div id="alerts-list" class="card-grid"></div>
      </section>


      <section data-view="settings" class="view hidden">
        <h1>Ajustes</h1>

        <div class="card">
          <h2>üîî Notifica√ß√µes e Alertas</h2>
          
          <div class="field">
            <label style="display:flex; align-items:center; gap:8px;">
              <input id="toggle-bark-sounds" type="checkbox" />
              <span>üê∂ Sons de latido no app (quando aberto)</span>
            </label>
            <p class="hint">Toca "au-au" quando h√° pend√™ncias ao abrir o app ou registrar a√ß√µes</p>
          </div>

          <div class="field">
            <label style="display:flex; align-items:center; gap:8px;">
              <input id="toggle-push-notifications" type="checkbox" />
              <span>üìß Push Notifications (quando app fechado)</span>
            </label>
            <p class="hint" id="push-status-text">Status: Desativado</p>
          </div>

          <div class="field" id="push-inbox-field" hidden>
            <div style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
              <div class="small-text" style="font-weight:600;">Notifica√ß√µes recebidas</div>
              <button id="btn-mark-push-read" class="btn secondary">Marcar como lidas</button>
            </div>
            <div id="push-inbox-list" class="list" style="margin-top:8px"></div>
            <p class="hint">Ao abrir o app, as notifica√ß√µes s√£o marcadas como lidas e o n√∫mero do atalho √© limpo.</p>
          </div>

          <div class="field">
            <label for="alert-days-ahead">Alertar com anteced√™ncia de (dias):</label>
            <input id="alert-days-ahead" type="number" min="1" max="30" value="7" />
            <p class="hint">Avisar quando algo vencer em at√© X dias</p>
          </div>

          <div class="actions-row" style="flex-wrap:wrap; gap:8px;">
            <button id="btn-test-bark" class="btn secondary">üîä Testar latido</button>
            <button id="btn-test-push" class="btn secondary">üìß Enviar push de teste</button>
            <button id="btn-ics-all" class="btn">üìÖ Exportar calend√°rio (.ics)</button>
          </div>
        </div>

        <div class="card">
          <h2>üíæ Backup</h2>
          <div class="actions-row">
            <button id="btn-export" class="btn">Exportar JSON</button>
            <label class="btn secondary">
              Importar JSON
              <input id="import-file" type="file" accept="application/json" hidden />
            </label>
          </div>
          <p class="small-text">Exporta e importa tudo (peso, rem√©dios, vacinas, rotinas, alimenta√ß√£o e hist√≥rico).</p>
        </div>

        <div class="card">
          <h2>üìñ Como usar notifica√ß√µes</h2>
          <details>
            <summary style="cursor:pointer; font-weight:600; margin-bottom:8px;">üì± Importar eventos no Google Agenda (Mobile)</summary>
            <ol class="small-text">
              <li>Clique em "Exportar calend√°rio (.ics)" acima</li>
              <li>Baixe o arquivo .ics</li>
              <li>Abra o Google Agenda no celular</li>
              <li>Toque em ‚ãÆ (menu) > Configura√ß√µes > Importar eventos</li>
              <li>Selecione o arquivo baixado</li>
            </ol>
          </details>
          
          <details style="margin-top:12px;">
            <summary style="cursor:pointer; font-weight:600; margin-bottom:8px;">üíª Importar eventos no Google Agenda (Desktop)</summary>
            <ol class="small-text">
              <li>Clique em "Exportar calend√°rio (.ics)" acima</li>
              <li>Acesse <a href="https://calendar.google.com" target="_blank">Google Agenda</a></li>
              <li>No menu lateral, clique na engrenagem ‚öôÔ∏è > Configura√ß√µes</li>
              <li>Clique em "Importar e exportar" na barra lateral</li>
              <li>Clique em "Selecionar arquivo do computador"</li>
              <li>Escolha o arquivo .ics baixado e clique em "Importar"</li>
            </ol>
          </details>
        </div>

        <div class="card">
          <h2>‚ÑπÔ∏è Sobre</h2>
          <p class="small-text">Funciona offline ap√≥s o primeiro acesso. Dados salvos localmente no seu navegador.</p>
          <p class="small-text"><strong>Limita√ß√µes:</strong> Push notifications n√£o suportam som customizado (usam som padr√£o do sistema). Sons de latido funcionam apenas quando o app est√° aberto.</p>
        </div>
      
        <div class="card">
          <h2>ü©∫ Modo Veterin√°rio</h2>
          <p class="small-text">Gera um relat√≥rio resumido do Scooby (peso, vacinas, rem√©dios, rotinas e hist√≥rico) pronto pra salvar em PDF.</p>
          <div class="actions-row">
            <button id="btn-vet-pdf" class="btn primary">Gerar relat√≥rio (PDF)</button>
          </div>
        </div>

      </section>
    </main>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script src="app.js" type="module"></script>

    <!-- Modal de data (para registrar dose/a√ß√£o em um dia espec√≠fico) -->
    
    <dialog id="date-dialog" class="date-dialog">
      <form method="dialog" class="date-dialog-card">
        <h3 id="date-dialog-title">Selecionar data</h3>
        <p class="small-text" id="date-dialog-sub">Escolha a data do registro.</p>

        <div class="date-picker" aria-label="Calend√°rio">
          <div class="date-picker__top">
            <button class="icon-btn" id="dp-prev" value="noop" aria-label="M√™s anterior">‚Äπ</button>
            <div class="date-picker__month" id="dp-month">‚Äî</div>
            <button class="icon-btn" id="dp-next" value="noop" aria-label="Pr√≥ximo m√™s">‚Ä∫</button>
          </div>

          <div class="date-picker__dow">
            <span>Dom</span><span>Seg</span><span>Ter</span><span>Qua</span><span>Qui</span><span>Sex</span><span>S√°b</span>
          </div>

          <div class="date-picker__grid" id="dp-grid"></div>

          <div class="field" style="margin-top:10px">
            <label for="date-dialog-input">Data selecionada</label>
            <input id="date-dialog-input" type="text" inputmode="numeric" placeholder="AAAA-MM-DD" required />
          </div>
          <p class="small-text muted" id="dp-hint" style="margin-top:6px">Dica: clique num dia do calend√°rio ou digite a data.</p>
        </div>

        <div class="actions-row" style="justify-content:flex-end; margin-top:14px">
          <button class="btn" value="cancel">Cancelar</button>
          <button class="btn primary" id="date-dialog-ok" value="ok">Salvar</button>
        </div>
      </form>
    </dialog>


</body>
</html>
